apiVersion: v1
kind: Secret
metadata:
  name: app-tls
  namespace: cert-mismatch
  annotations:
    argocd.argoproj.io/sync-wave: "2"
type: kubernetes.io/tls
data:
  # Self-signed certificate for api.example.com (WRONG CN - should be app.example.com)
  # This is the BUG: certificate CN doesn't match the Ingress host
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURGVENDQWYyZ0F3SUJBZ0lVUlJUK28xcm9YenlXUHRsUEtrOXhveEMvRVdBd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0dqRVlNQllHQTFVRUF3d1BZWEJwTG1WNFlXMXdiR1V1WTI5dE1CNFhEVEkyTURFeE1URXdNalUwTlZvWApEVEkzTURFeE1URXdNalUwTlZvd0dqRVlNQllHQTFVRUF3d1BZWEJwTG1WNFlXMXdiR1V1WTI5dE1JSUJJakFOCkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXVHVkVyZWxUQmgrdlhKTVIvZHlGc0dLZkNQQVYKYm94ajNNR0xpSnFSVllNbTg1eFRxc2FUVmpkU2JCR3UybDlVa1hWeE1MNUtWVy9yd2tYMXpSRmxpYWduL29HMgpWdTJoU3ZiR0xxNkQxZmhMUUwvR0szd2l5MTdtTWZMaDJOVFJIeklUVHM0UHFhZS9BdlpzY0FFVGxjb0ZRYVVOCkFoU3JTS3BlTmd1RmNmY2VpeVdLRkVZNitwZnAwYlJNMlZTKyswZ3dPSkJkSUJ2cDlxSHFqMW1kK3NMVUFiZkwKSmZQbVJUTFlTZW5kYjlWNmgrbzlHOHloUXlJNnd0NlYwczJtOXNtMDN6TUUwWXA2R0drbWxULzVjZDR3UEE4cgp3Z2NQM3VNMnZ3cjk5ZEVzOTdkTG9uY3pLN1gzbHA3SXlxN3ZHTllKemg3V0N0MG9TVlRYV3pyN0ZRSURBUUFCCm8xTXdVVEFkQmdOVkhRNEVGZ1FVb2VoYWJJOGY4TWd2K2h2YUVnNksxK2RSaWYwd0h3WURWUjBqQkJnd0ZvQVUKb2VoYWJJOGY4TWd2K2h2YUVnNksxK2RSaWYwd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBTkJna3Foa2lHOXcwQgpBUXNGQUFPQ0FRRUFuMWZoRVNSMktqL0RIck8zT1BoQWpweUloQlVOcTB0Vi9FalRWL1hQQUdxWFpJZVRtYlBQCm45dVJhUTRPa0pCUzNwbXNlTFAwNUpCdVgwQ3NDZlgrejVEbTZ6blhTTEMyYmtzeVk0eEFYSEJDcnB6dm0yenIKTUFYUVN6ME9TaFVqbU11eFF2MTZjcXl1WXlFWldFS21GY250RzdDYmFDY0c0bU9oVlhobTh2RDJHbXo1eEdhSAppejZPVTd3ckY0anlBSld1L0VHbmZZbTVVZlV5Zk5HaGRDOVlOYjlkRmxSam1veTdxajFwM2NRY1Fob2ZrMSs2CjQ2V2NSbzRyeUIvZy9lYkMzcEZxS1Z6NmtzRFQzODlHTFJ0cEV6R21XYmh2MkRiNFhaMnQ3dlphVWNVUXZsZmYKM3pZem9ITlFFU3pLVEt6dlg5YndkMXNPRDVqem03ckVyQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2QUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktZd2dnU2lBZ0VBQW9JQkFRQzRaVVN0NlZNR0g2OWMKa3hIOTNJV3dZcDhJOEJWdWpHUGN3WXVJbXBGVmd5YnpuRk9xeHBOV04xSnNFYTdhWDFTUmRYRXd2a3BWYit2QwpSZlhORVdXSnFDZitnYlpXN2FGSzlzWXVyb1BWK0V0QXY4WXJmQ0xMWHVZeDh1SFkxTkVmTWhOT3pnK3BwNzhDCjlteHdBUk9WeWdWQnBRMENGS3RJcWw0MkM0Vng5eDZMSllvVVJqcjZsK25SdEV6WlZMNzdTREE0a0YwZ0crbjIKb2VxUFdaMzZ3dFFCdDhzbDgrWkZNdGhKNmQxdjFYcUg2ajBiektGRElqckMzcFhTemFiMnliVGZNd1RSaW5vWQphU2FWUC9seDNqQThEeXZDQncvZTR6YS9DdjMxMFN6M3QwdWlkek1ydGZlV25zaktydThZMWduT0h0WUszU2hKClZOZGJPdnNWQWdNQkFBRUNnZ0VBRUlzSC8xdWpMRFhPMk0wRkJ6UGFvVTdTYjgzWG83bTFWOS9jQnpScGZOK0QKQmh0c3A0ZExQcWZyU0J0MHNYakRXemdnZGVhM1A5K3cvMnYydDhyV0dPU0hqMTRrZFdZUHNNRzFCQWtreTNTTQpPU2M3YUk2cGh5UzJIWjIvR2d5Z2VsNVd2SEkyUU5xZzJNRGM5NnQ3dUt1Tmp5eDNTZmJWYXg2RnpKbDZBOEJUCkhWM1FvZ0NXZy9kSjZnYnE5SDVjL1lHRDNyRk9ybkx4ck5GVXlab1RtRmNFK3dCK04wY0krVWZFelZSUStrdVcKZnl3VHgvSysxZ0Fyc1BOOTY2b01wV3BqOUJPY0ZXck84UHBDekpYUFppY0lSNWQxSUZlMi91V04zSzNpUlptcAphb0hldnNNdGFHbEhDaFdwSmpYSjBuaVNubXVjcE9mbnlsSXYrM2ZGZlFLQmdRRHZVRmIyMGEzSEtJeWMwWlVRClU3bzQvbFhSdExWZWN4b0RqUXk3a1RqbkQwRjA3STdoVkV1UmpVQ2x6NDBibUphak8rdDdmaHRncW0zcFhQUkEKWHlZY29tdzd4blRaRExxTFRzdGU4M09leE5rZDVVNUlEUXJTMngzaVAzQTNmS3QwZENjMWlYMkx0cnlGdHU1NQpnNE0wS1MyUUdYREViWDl0MHJIMUo0NDRUd0tCZ1FERlFLaXFvbTZEOXRSUXJGQ25xNDU0aG9MQ2x2WTBtbkpiCnNMS1hGYjh3N2ZtU01wSjVQQjI3aUJBOGNjQTBFOHloWS9JMFVEMjA5ZXhIdG1JMGE0T09QZzU5ZVUzblZtS2gKemNtUHh1eit5emU3dGZ5VWx0Vm1paWVOVW9YWmFCRnVNdEFicEtQWUdDazdZNzVrVS9INi9JN0ljTkg4aE5SSgpRNjVadEc3Wld3S0JnRXVsYlpmZmQ3cjRpbG9YdGJMUGhKSDNjMUV5ZWhJOCtBQWZXZU1BYUtoQkhrUERjdmF2CkdxUUxybCs3VjdOZGJHQjAxRjdZNGZhUWFPWFhTQzRBNVo4dmlGN3N3SXJMaHp2NTBEZFhaVGpPcUlMV3RRUDUKZTI1amJQTFRjcmxYWXlzUWZFUmtEWmRZVUFkRVorVnBPTlFJSUNyb244aTNoQXhIQ1pHZ3kwZnBBb0dBQ1o2SgpteWlvc3c3S2M5U3pham5Yak5FaWQxTGRWdHRoVUU5aHBqU05TbG1Rbml5Uk1CQmFjdGJEMCs3SUxNSDZiTFJ2CkQxWUtiRlRCM1ExcjVKcUpvOW9xNHJ1VHJRQnRkdTZPTWRERnBmZExGSUJmZk8rT0lKNEVKOFFxZXR1MFhlZGsKZHJTa3VOa1V5YXlua0VUM3ZBR3RCT0ZibkREdUdWU1BvQmhJZjVrQ2dZQUdaUlF1N1FvQ3MvUVVnaTQzT3EwZgpCMEdnY0x4emZuc2R0aHpZMXJ5RXcwMUFlQTVwNHBsUGxjUGhZVFZ0dTNvM0dGdndBTUJkQ0tYVlY4SlYwajRjCkpyVkl6SUhVWXBqM2xjK04wY2VKS1JTMzd5aUE5aXFwajVFVFBnM1lsbnZyYitpd0laNHFMR3B1cXJWcHNja1UKbzhnTFBwb043YlcwdllLc1lCaWRFZz09Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: secure-app
  namespace: cert-mismatch
  annotations:
    argocd.argoproj.io/sync-wave: "3"
spec:
  ingressClassName: nginx
  tls:
    - hosts:
        - api.example.com  # BUG: Should be app.example.com to match the rules
      secretName: app-tls
  rules:
    - host: app.example.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: secure-app
                port:
                  number: 80
