title: Traffic Jam
description: |
  The pods work. The Service exists. The Ingress is configured. Yet: 503.
  Something invisible is blocking the traffic.
theme: networking
difficulty: hard
type: fix
estimatedTime: 20
initialSituation: |
  A microservice was deployed behind an Ingress controller for external access.
  The pods are Running and respond perfectly when accessed directly.
  The Service configuration looks correct and matches the pod labels.
  But accessing through the Ingress consistently returns 503 Service Unavailable.
objective: |
  Find what's breaking the traffic flow from Ingress to pods.
  Everything looks right on paper - dig deeper.

objectives:
  - key: pods-ready-check
    title: "API Pods Ready"
    description: "All API pods must be running and in Ready state"
    order: 1
    type: condition
    spec:
      target:
        kind: Pod
        labelSelector:
          app: api-service
      checks:
        - type: Ready
          status: "True"

  - key: service-direct-check
    title: "Service Connectivity"
    description: "The api-service must be reachable directly within the cluster"
    order: 2
    type: connectivity
    spec:
      sourcePod:
        labelSelector:
          app: api-service
      targets:
        - url: "http://api-service"
          expectedStatusCode: 200
          timeoutSeconds: 5

  - key: ingress-routing-check
    title: "Ingress Routing"
    description: "External traffic must be correctly routed to the API service"
    order: 3
    type: connectivity
    spec:
      sourcePod:
        labelSelector:
          app: api-service
      targets:
        - url: "http://ingress-nginx-controller.ingress-nginx.svc.cluster.local"
          expectedStatusCode: 200
          timeoutSeconds: 5
