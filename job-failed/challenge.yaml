title: Job Failed
description: |
  The nightly data processing job has been failing for the past week.
  It starts, runs for a while, then suddenly disappears.
theme: jobs-cronjobs
difficulty: medium
type: fix
estimatedTime: 15
initialSituation: |
  A CronJob that processes data every night has been consistently failing.
  Looking at the Job status, you see it has failed multiple times.
  The pod runs for about 30 seconds, then gets terminated.
  kubectl describe job shows "DeadlineExceeded" in the events.
  The data processing script itself takes about 60 seconds to complete.
objective: |
  Investigate why the job keeps getting terminated and fix the configuration.
  The processing workflow must complete successfully.

objectives:
  - key: job-completion-check
    title: "Job Completed"
    description: "The data-processor Job must complete successfully"
    order: 1
    type: metrics
    spec:
      target:
        kind: Job
        labelSelector:
          app: data-processor
      checks:
        - field: status.succeeded
          operator: ">="
          value: 1

  - key: job-logs-check
    title: "Job Logs Check"
    description: "The data-processor job must log 'Data processing completed successfully!'"
    order: 2
    type: log
    spec:
      target:
        kind: Pod
        labelSelector:
          app: data-processor
      container: processor
      expectedStrings:
        - "Data processing completed successfully!"
      sinceSeconds: 300
